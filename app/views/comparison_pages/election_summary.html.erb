<% provide(:title, @election.name) %>

<div class="election-summary-header">
  <div class="election-details-and-picture-container">
    <div class="columns">
  
      <!-- Election picture -->
      <div class="column is-narrow">
        <figure class="image election-picture-small">
          <%= image_tag(get_election_picture_url(@election.id), alt: @election.name) %>
        </figure>
      </div>
    
      <!-- Election details -->
      <div class="column">
        <p class="election-name">
          <%= @election.name %>
        </p>
        <p><%= display_election_date(@election.election_date) %></p>
      </div>
    </div>
  </div>
</div>

<% if @content_top %>
  <%= sanitize @content_top.content %>
<% end %>

<!-- COMPARE PARTY LEADERS (if enabled) -->
<% if @party_leaders %>
  <%= link_to compare_party_leaders_path(@election.slug) do %>
    <div class="box">
      <div class="election-section-heading">
        Compare Party Leaders
      </div>
      <div class="columns is-multiline is-mobile">
        <% @party_leaders.each do |p| %>
          <div class="column is-half-mobile is-half-tablet is-one-third-desktop is-one-third-widescreen is-one-third-fullhd">
            <%= render 'comparison_pages/comparison_participant_header', participant_id: p.id, party_id: p.party_id, avatar_image_class: 'avatar-small' %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
<% end %>

<!-- COMPARE PARTY PLATFORMS (if enabled) -->
<% if @parties %>
  <%= link_to compare_party_platforms_path(@election.slug) do %>
    <div class="box">
      <div class="election-section-heading">
        Compare Party Platforms
      </div>
      <div class="columns is-multiline is-mobile">
        <% @parties.each do |p| %>
          <div class="column is-half-mobile is-half-tablet is-one-third-desktop is-one-third-widescreen is-one-third-fullhd">
            <%= render 'comparison_pages/comparison_participant_header', participant_id: p.id, party_id: p.party_id, avatar_image_class: 'avatar-small' %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
<% end %>

<!-- COMPARE CANDIDATES FOR OFFICE -->
<% @election.offices.order(:order).each do |office| %>

  <% if office.districts.empty? %>

    <!-- WITHOUT DISTRICTS -->
    <%= link_to compare_candidates_path(election_slug: @election.slug, office_id: office.id) do %>
      <div class="box">
        <div class="election-section-heading">
          Compare Candidates for <%= office.name %>
        </div>
        <div class="columns is-multiline is-mobile">
          <% @election.candidates_for_display(office.id).each do |p| %>
            <div class="column is-half-mobile is-half-tablet is-one-third-desktop is-one-third-widescreen is-one-third-fullhd">
              <%= render 'comparison_pages/comparison_participant_header', participant_id: p.id, party_id: p.party_id, avatar_image_class: 'avatar-small' %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

  <% else %>

    <!-- WITH DISTRICTS -->
    <%= form_with(url: election_summary_path(@election.slug), method: "get", local: true) do |f| %>
      <%= hidden_field_tag :office_id, office.id %>
      <div class="box">
        <div class="election-section-heading">
          Compare Candidates for <%= office.name %>
        </div>
        <div class="columns is-multiline is-mobile is-centered is-vcentered">
          <div class="column is-12-mobile is-narrow-tablet is-narrow-desktop is-narrow-widescreen is-narrow-fullhd">
            <%= f.label "Select your district", class: 'label' %>
          </div>
          <div class="column is-12-mobile is-narrow-tablet is-narrow-desktop is-narrow-widescreen is-narrow-fullhd">
            <div class="select">
              <%= f.select(:district_id, options_for_select(options_for_district(office.id))) %>
            </div>
          </div>
          <div class="column is-12-mobile is-narrow-tablet is-narrow-desktop is-narrow-widescreen is-narrow-fullhd">
            <%= f.submit "Go!", class: "button is-primary" %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>

<% if @content_bottom %>
  <%= sanitize @content_bottom.content %>
<% end %>